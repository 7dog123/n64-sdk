<html>
<title>
Envelope System
</title>
<body bgcolor="ffffff">
<h2>
Appendix 4: Envelope System
</h2>
<hr size="3">
<blockquote>

NIFF 2.0 has a data area for use by the Envelope System.<p>
The Envelope System is a system for the animation of 1 Skin being affected by multiple nodes.<p>
In NIFF 2.0, the geometry for the Envelope is divided and registered as three parts, as shown in Figure 1 below.<p>
<center>
<img src="./img/envelope_part.jpg">
<p>
<b>
Figure 1: Envelope part
</b>
<p>
</center>
In a Full Weighted part, all of the vertices inside the part receive 100% of their influence from a single node.  For example, in the top portion of Figure 1 above, the vertices within the parts surrounded by the blue lines move as a single joint.<p>
When all vertices are created as Full Weighted, the result is as shown in Figure 2 below.<p>
Here, the red vertices receive 100% of their influence from the red joint, and the blue vertices receive 100% of their influence from the blue joint.<p>
<center>
<img src="./img/full_weighted.jpg">
<p>
<b>
Figure 2:  A Skin created from two Full Weighted parts.
</b>
<p>
</center>
The Morph part is used in situations where only two nodes will cause a part to deform, such as the area inside the red line in Figure 1, where the part is linked to two nodes in only one direction of rotation.  The angle between the nodes which comes from this rotation has values equally spaced between 0 and 180 degrees.  The angle values act as the parameters to output vertex positions and perform vertex animation.<p>
<center>
<img src="./img/morph.jpg">
<p>
<b>
Figure 3: Angle of the Morph part
</b>
<p>
</center>
A table like the one shown in Figure 4 below is created for angle 0 to angle 180.  The data is stored in order from table #0.<p>
<center>
<img src="./img/table_for_morph_part.jpg">
<p>
<b>
Figure 4: Creating data for a Morph part
</b>
<p>
</center>
A Weighted part is calculated using the different weight values for each of the numerous nodes from which it receives influence.  In the bottom portion of Figure 1, the area within the green line falls under this category.  In this case, weight values from identical nodes are grouped at the same vertex and output as a single part.
</blockquote>

<hr>
<i>
Copyright 1998, 1999 NINTENDO Co., Ltd. All rights reserved.<br>
Copyright 1998, 1999 MONEGI CORPORATION All rights reserved.
</i>


</body>
</html>